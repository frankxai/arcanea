[pytest]
# Test discovery patterns
testpaths = tests/integration tests/python
test_files = *_test.py test_*.py *_tests.py
python_files = *_test.py test_*.py *_tests.py
python_classes = Test*
python_functions = test_*

# Python path
pythonpath = . tests

# Markers for test categories
markers =
    unit: Unit tests (fast, isolated)
    integration: Integration tests (requires external services)
    e2e: End-to-end tests (full system)
    slow: Slow tests (>5 seconds)
    mcp: MCP client tests
    knowledge: Knowledge base tests
    auth: Authentication tests
    sync: Synchronization tests
    smoke: Smoke tests (quick health checks)
    critical: Critical path tests

# Coverage configuration
addopts = 
    -v
    --tb=short
    --strict-markers
    --cov=.
    --cov-report=term-missing
    --cov-report=html:coverage/python
    --cov-report=xml:coverage/coverage.xml
    --cov-report=lcov:coverage/lcov.info
    --cov-fail-under=70

# Coverage source
cov_source = 
    arcanea_infogenius_bridge
    arcanea_unified_hub
    arcanea_unified_knowledge

# Coverage omit patterns
cov_omit =
    */tests/*
    */test_*
    */venv/*
    */virtualenv/*
    */env/*
    */__pycache__/*
    */node_modules/*
    */.arcanea/*
    */apps/*
    */starlight-intelligence-system/*

# Filter warnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning

# Console output
console_output_style = progress

# Xfail strict mode
xfail_strict = true

# Cache directory
cache_dir = .pytest_cache

# Log configuration
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s (%(filename)s:%(lineno)s)
log_cli_date_format = %Y-%m-%d %H:%M:%S

# JUnit XML output
junit_family = xunit2
junit_suite_name = Arcanea Python Tests
