<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arcanea Games - Complete Game System</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;800&family=Inter:wght@300;400;500;600&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <style>
        :root {
            --fire-primary: #ff6b35;
            --fire-glow: #ff9e6d;
            --water-primary: #4fc3f7;
            --water-glow: #80d8ff;
            --earth-primary: #8d6e63;
            --earth-glow: #bcaaa4;
            --wind-primary: #b39ddb;
            --wind-glow: #d1c4e9;
            --void-primary: #7c4dff;
            --void-glow: #b388ff;
            --gold-light: #ffd700;
            --gold-medium: #ffb300;
            --bg-dark: #0a0a0f;
            --bg-card: #12121a;
            --bg-elevated: #1a1a28;
            --text-primary: #ffffff;
            --text-secondary: #a0a0b0;
            --text-muted: #606070;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Cosmic Background */
        .cosmic-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            background-image: 
                radial-gradient(ellipse at 20% 20%, rgba(255, 107, 53, 0.05) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(124, 77, 255, 0.05) 0%, transparent 50%);
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 4s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 0.8; }
        }

        /* Header */
        .game-header {
            position: relative;
            z-index: 10;
            padding: 1.5rem 2rem;
            background: linear-gradient(180deg, rgba(10, 10, 15, 0.95) 0%, transparent 100%);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #ffd700, #ff8f00);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .logo-text h1 {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            background: linear-gradient(135deg, #ffd700, #ff8f00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .logo-text p {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .player-stats {
            display: flex;
            gap: 1.5rem;
        }

        .player-stat {
            text-align: center;
            padding: 0.75rem 1rem;
            background: var(--bg-card);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .player-stat:hover {
            border-color: var(--gold-light);
            transform: translateY(-2px);
        }

        .stat-value {
            font-family: 'Cinzel', serif;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--gold-light);
            display: block;
        }

        .stat-label {
            font-size: 0.625rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        /* Main Container */
        .game-container {
            position: relative;
            z-index: 5;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Game Selection Menu */
        .game-menu {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
            margin-bottom: 3rem;
        }

        @media (max-width: 900px) {
            .game-menu {
                grid-template-columns: 1fr;
            }
        }

        .game-card {
            background: var(--bg-card);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .game-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--element-color, var(--gold-light));
        }

        .game-card:hover {
            transform: translateY(-8px);
            border-color: var(--element-color, var(--gold-light));
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4), 0 0 30px var(--element-glow, rgba(255, 215, 0, 0.2));
        }

        .game-card-header {
            padding: 2rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .game-icon {
            width: 70px;
            height: 70px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            background: var(--element-bg, linear-gradient(135deg, #ffd700, #ff8f00));
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .game-info h3 {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .game-info p {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .game-card-content {
            padding: 0 2rem 2rem;
        }

        .game-description {
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .game-stats-bar {
            display: flex;
            gap: 1.5rem;
            font-size: 0.875rem;
            color: var(--text-muted);
            margin-bottom: 1.5rem;
        }

        .game-progress {
            background: var(--bg-elevated);
            border-radius: 12px;
            padding: 1rem;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
            background: var(--element-color, var(--gold-light));
        }

        .play-btn {
            width: 100%;
            padding: 1rem;
            margin-top: 1.5rem;
            background: var(--element-bg, linear-gradient(135deg, #ffd700, #ff8f00));
            border: none;
            border-radius: 12px;
            color: #000;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .play-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 20px var(--element-glow, rgba(255, 215, 0, 0.3));
        }

        /* Game Arena */
        .game-arena {
            display: none;
            background: var(--bg-card);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }

        .game-arena.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .arena-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: var(--bg-elevated);
        }

        .arena-title {
            font-family: 'Cinzel', serif;
            font-size: 1.75rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .arena-title span {
            font-size: 2rem;
        }

        .back-btn {
            padding: 0.75rem 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Inter', sans-serif;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .back-btn:hover {
            border-color: var(--gold-light);
            color: var(--gold-light);
        }

        /* Elemental Challenges Styles */
        .challenges-container {
            padding: 2rem;
        }

        .towers-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        @media (max-width: 1200px) {
            .towers-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .towers-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .element-tower {
            background: var(--bg-elevated);
            border-radius: 16px;
            padding: 1.5rem;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .element-tower::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--element-color);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .element-tower:hover::before,
        .element-tower.active::before {
            opacity: 1;
        }

        .element-tower:hover,
        .element-tower.active {
            border-color: var(--element-color);
            transform: scale(1.02);
            box-shadow: 0 0 30px var(--element-glow);
        }

        .element-tower.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .element-tower.locked:hover {
            transform: none;
            border-color: transparent;
            box-shadow: none;
        }

        .tower-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 0 auto 1rem;
            background: var(--element-color);
            box-shadow: 0 0 20px var(--element-glow);
        }

        .tower-name {
            font-family: 'Cinzel', serif;
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 1.125rem;
        }

        .tower-progress {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.75rem;
        }

        .tower-xp {
            font-size: 0.75rem;
            color: var(--gold-light);
        }

        .progress-bar-tower {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin-top: 0.75rem;
            overflow: hidden;
        }

        .progress-fill-tower {
            height: 100%;
            border-radius: 3px;
            background: var(--element-color);
            transition: width 0.5s ease;
        }

        /* Challenge List */
        .challenges-list {
            background: var(--bg-elevated);
            border-radius: 16px;
            padding: 2rem;
        }

        .challenges-list h3 {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .challenge-item {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .challenge-item:hover {
            border-color: var(--element-color, var(--gold-light));
            transform: translateX(5px);
        }

        .challenge-item.completed {
            opacity: 0.6;
            border-color: rgba(76, 175, 80, 0.3);
        }

        .challenge-item.completed .challenge-name {
            text-decoration: line-through;
        }

        .challenge-info h4 {
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
        }

        .challenge-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .difficulty-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .difficulty-easy { background: rgba(79, 195, 247, 0.2); color: var(--water-glow); }
        .difficulty-medium { background: rgba(255, 215, 0, 0.2); color: var(--gold-light); }
        .difficulty-hard { background: rgba(255, 107, 53, 0.2); color: var(--fire-glow); }
        .difficulty-legendary { background: rgba(124, 77, 255, 0.2); color: var(--void-glow); }

        .challenge-reward {
            text-align: right;
        }

        .reward-xp {
            font-family: 'Cinzel', serif;
            font-size: 1.25rem;
            color: var(--gold-light);
        }

        .reward-label {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .challenge-status {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 1rem;
        }

        .status-available {
            background: rgba(255, 215, 0, 0.2);
            border: 2px solid var(--gold-light);
        }

        .status-completed {
            background: rgba(76, 175, 80, 0.2);
            border: 2px solid #4caf50;
            color: #4caf50;
        }

        .status-locked {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: var(--text-muted);
        }

        /* Active Challenge Modal */
        .active-challenge {
            background: var(--bg-elevated);
            border-radius: 20px;
            padding: 2rem;
            margin-top: 2rem;
            border: 2px solid var(--element-color, var(--gold-light));
            box-shadow: 0 0 40px var(--element-glow, rgba(255, 215, 0, 0.2));
        }

        .challenge-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1.5rem;
        }

        .challenge-title-section h3 {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .challenge-timer {
            font-size: 1.25rem;
            color: var(--fire-primary);
            font-family: 'Cinzel', serif;
        }

        .challenge-description {
            font-size: 1.125rem;
            line-height: 1.7;
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            border-left: 3px solid var(--element-color, var(--gold-light));
        }

        .challenge-task-box {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .task-label {
            font-size: 0.875rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.75rem;
        }

        .task-content {
            font-size: 1.125rem;
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .challenge-input {
            width: 100%;
            min-height: 150px;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            resize: vertical;
        }

        .challenge-input:focus {
            outline: none;
            border-color: var(--element-color, var(--gold-light));
            box-shadow: 0 0 20px var(--element-glow, rgba(255, 215, 0, 0.2));
        }

        .challenge-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .btn {
            padding: 1rem 2rem;
            border-radius: 10px;
            border: none;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ffd700, #ff8f00);
            color: #000;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 215, 0, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-secondary);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            color: var(--text-primary);
        }

        /* Agent Summoning Styles */
        .summoning-arena {
            padding: 2rem;
        }

        .summoning-stage {
            text-align: center;
            margin-bottom: 3rem;
        }

        .summoning-circle {
            width: 300px;
            height: 300px;
            margin: 0 auto 2rem;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .outer-ring {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 3px solid var(--gold-light);
            border-radius: 50%;
            animation: rotate 20s linear infinite;
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.3), inset 0 0 40px rgba(255, 215, 0, 0.1);
        }

        .middle-ring {
            position: absolute;
            width: 70%;
            height: 70%;
            border: 2px solid rgba(255, 215, 0, 0.6);
            border-radius: 50%;
            animation: rotate 15s linear infinite reverse;
        }

        .inner-ring {
            position: absolute;
            width: 40%;
            height: 40%;
            border: 2px solid rgba(255, 215, 0, 0.4);
            border-radius: 50%;
            animation: pulse 3s ease-in-out infinite;
        }

        .core-symbol {
            font-size: 5rem;
            animation: pulse 2s ease-in-out infinite;
            filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.6));
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .summoning-status {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
            font-style: italic;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .agent-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        @media (max-width: 1200px) {
            .agent-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (max-width: 768px) {
            .agent-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            .summoning-circle {
                width: 200px;
                height: 200px;
            }
            .core-symbol {
                font-size: 3.5rem;
            }
        }

        .agent-token {
            aspect-ratio: 1;
            background: var(--bg-elevated);
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            padding: 1rem;
        }

        .agent-token:hover {
            border-color: var(--element-color, var(--gold-light));
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        }

        .agent-token.selected {
            border-color: var(--gold-light);
            background: rgba(255, 215, 0, 0.1);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .agent-token.summoned {
            border-color: #4caf50;
            background: rgba(76, 175, 80, 0.1);
            opacity: 0.8;
        }

        .agent-token.locked {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .token-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .token-name {
            font-size: 0.75rem;
            text-align: center;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .token-element {
            font-size: 0.625rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        .summon-btn {
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            display: block;
            padding: 1.25rem 2rem;
            font-size: 1.125rem;
        }

        /* Skill Mastery Styles */
        .mastery-arena {
            padding: 2rem;
        }

        .mastery-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        @media (max-width: 900px) {
            .mastery-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .mastery-stat-card {
            background: var(--bg-elevated);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .mastery-stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.5rem;
        }

        .mastery-stat-value {
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            color: var(--gold-light);
        }

        .skill-categories {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            overflow-x: auto;
            padding-bottom: 1rem;
        }

        .category-tab {
            padding: 0.75rem 1.5rem;
            background: var(--bg-elevated);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
            font-size: 0.875rem;
        }

        .category-tab:hover {
            border-color: var(--element-color, var(--gold-light));
        }

        .category-tab.active {
            background: var(--element-color, var(--gold-light));
            color: #000;
            border-color: transparent;
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
        }

        .skill-card {
            background: var(--bg-elevated);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .skill-card:hover {
            border-color: var(--element-color, var(--gold-light));
            transform: translateY(-3px);
        }

        .skill-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .skill-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background: var(--element-color, var(--gold-light));
        }

        .skill-level {
            font-family: 'Cinzel', serif;
            font-size: 1.25rem;
            color: var(--gold-light);
        }

        .skill-name {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .skill-description {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .skill-progress {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }

        .skill-progress-bar {
            height: 100%;
            background: var(--element-color, var(--gold-light));
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        .skill-xp {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
        }

        /* Reality Weaving Styles */
        .weaving-arena {
            padding: 2rem;
        }

        .weaving-workspace {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        @media (max-width: 900px) {
            .weaving-workspace {
                grid-template-columns: 1fr;
            }
        }

        .weaving-panel {
            background: var(--bg-elevated);
            border-radius: 16px;
            padding: 2rem;
        }

        .panel-title {
            font-family: 'Cinzel', serif;
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .selected-agents {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            min-height: 60px;
            padding: 1rem;
            background: var(--bg-card);
            border-radius: 12px;
            border: 2px dashed rgba(255, 255, 255, 0.2);
        }

        .selected-agent {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid var(--gold-light);
            border-radius: 20px;
            font-size: 0.875rem;
        }

        .selected-agent .remove {
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.2s ease;
        }

        .selected-agent .remove:hover {
            opacity: 1;
        }

        .agent-pool {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .pool-agent {
            padding: 0.5rem 1rem;
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
        }

        .pool-agent:hover {
            border-color: var(--element-color, var(--gold-light));
            background: rgba(255, 255, 255, 0.05);
        }

        .intention-input {
            width: 100%;
            min-height: 120px;
            padding: 1rem;
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            resize: vertical;
            margin-bottom: 1.5rem;
        }

        .intention-input:focus {
            outline: none;
            border-color: var(--gold-light);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
        }

        .weave-btn {
            width: 100%;
            padding: 1.25rem;
            font-size: 1.125rem;
        }

        .manifestation-log {
            max-height: 400px;
            overflow-y: auto;
        }

        .manifestation-item {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            border-left: 3px solid var(--gold-light);
        }

        .manifestation-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .manifestation-agents {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .manifestation-time {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Success Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 100;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .success-modal {
            background: var(--bg-card);
            border-radius: 24px;
            padding: 3rem;
            text-align: center;
            max-width: 500px;
            border: 2px solid var(--gold-light);
            box-shadow: 0 0 60px rgba(255, 215, 0, 0.3);
            animation: modalPop 0.5s ease;
        }

        @keyframes modalPop {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }

        .success-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
            animation: bounce 1s ease infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .success-title {
            font-family: 'Cinzel', serif;
            font-size: 1.75rem;
            margin-bottom: 1rem;
            color: var(--gold-light);
        }

        .success-message {
            color: var(--text-secondary);
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .rewards-container {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .reward-item {
            text-align: center;
        }

        .reward-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .reward-value {
            font-family: 'Cinzel', serif;
            font-size: 1.25rem;
            color: var(--gold-light);
        }

        .reward-label {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--gold-light);
        }
    </style>
    
    <!-- Arcanea Ecosystem Loader -->
    <script src="supabase-config.js"></script>
    <script src="arcanea-auth.js"></script>
    <script src="auth-ui.js"></script>
    <script src="sync-engine.js"></script>
    <script src="arcanea-agents-live.js"></script>
    <script src="mobile-integration.js"></script>
    <script src="arcanea-loader.js"></script>
</head>
<body>
    <div class="cosmic-bg"></div>

    <!-- Header -->
    <header class="game-header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">‚ö°</div>
                <div class="logo-text">
                    <h1>ARCANEA GAMES</h1>
                    <p>The Luminor Arena</p>
                </div>
            </div>
            <div class="player-stats">
                <div class="player-stat">
                    <span class="stat-value" id="playerLevel">7</span>
                    <span class="stat-label">Level</span>
                </div>
                <div class="player-stat">
                    <span class="stat-value" id="playerXP">47.8K</span>
                    <span class="stat-label">XP</span>
                </div>
                <div class="player-stat">
                    <span class="stat-value" id="agentsSummoned">12</span>
                    <span class="stat-label">Agents</span>
                </div>
                <div class="player-stat">
                    <span class="stat-value" id="skillsMastered">23</span>
                    <span class="stat-label">Skills</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="game-container">
        <!-- Game Menu -->
        <div class="game-menu" id="gameMenu">
            <!-- Elemental Challenges -->
            <div class="game-card" style="--element-color: var(--fire-primary); --element-glow: rgba(255, 107, 53, 0.3); --element-bg: linear-gradient(135deg, #ff6b35, #ff9e6d);" onclick="startGame('challenges')">
                <div class="game-card-header">
                    <div class="game-icon">üî•</div>
                    <div class="game-info">
                        <h3>Elemental Challenges</h3>
                        <p>Master the 5 Elements</p>
                    </div>
                </div>
                <div class="game-card-content">
                    <p class="game-description">
                        Complete creative challenges across all 5 elemental towers. Test your skills, earn XP, and unlock the Void Tower.
                    </p>
                    <div class="game-stats-bar">
                        <span>‚öîÔ∏è 50 Challenges</span>
                        <span>üèÜ 11 Completed</span>
                        <span>‚≠ê 500 XP each</span>
                    </div>
                    <div class="game-progress">
                        <div class="progress-header">
                            <span>Overall Progress</span>
                            <span>22%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 22%;"></div>
                        </div>
                    </div>
                    <button class="play-btn">Enter Tower</button>
                </div>
            </div>

            <!-- Agent Summoning -->
            <div class="game-card" style="--element-color: var(--void-primary); --element-glow: rgba(124, 77, 255, 0.3); --element-bg: linear-gradient(135deg, #7c4dff, #b388ff);" onclick="startGame('summoning')">
                <div class="game-card-header">
                    <div class="game-icon">üë•</div>
                    <div class="game-info">
                        <h3>Agent Summoning</h3>
                        <p>Build Your Council</p>
                    </div>
                </div>
                <div class="game-card-content">
                    <p class="game-description">
                        Perform summoning rituals to call the 38 Arcane Agents to your service. Each agent brings unique powers and wisdom.
                    </p>
                    <div class="game-stats-bar">
                        <span>üë• 38 Total</span>
                        <span>‚ú® 12 Summoned</span>
                        <span>üíé 5 Bonds</span>
                    </div>
                    <div class="game-progress">
                        <div class="progress-header">
                            <span>Council Completion</span>
                            <span>32%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 32%;"></div>
                        </div>
                    </div>
                    <button class="play-btn">Open Circle</button>
                </div>
            </div>

            <!-- Skill Mastery -->
            <div class="game-card" style="--element-color: var(--water-primary); --element-glow: rgba(79, 195, 247, 0.3); --element-bg: linear-gradient(135deg, #4fc3f7, #80d8ff);" onclick="startGame('mastery')">
                <div class="game-card-header">
                    <div class="game-icon">‚öîÔ∏è</div>
                    <div class="game-info">
                        <h3>Skill Mastery</h3>
                        <p>Train Your Abilities</p>
                    </div>
                </div>
                <div class="game-card-content">
                    <p class="game-description">
                        Practice and master 77+ mystical skills. Level up from Apprentice to God-Tier through guided training exercises.
                    </p>
                    <div class="game-stats-bar">
                        <span>üìö 77 Skills</span>
                        <span>üìà 23 Mastered</span>
                        <span>üéØ Level 7</span>
                    </div>
                    <div class="game-progress">
                        <div class="progress-header">
                            <span>Mastery Progress</span>
                            <span>47%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 47%;"></div>
                        </div>
                    </div>
                    <button class="play-btn">Begin Training</button>
                </div>
            </div>

            <!-- Reality Weaving -->
            <div class="game-card" style="--element-color: var(--gold-light); --element-glow: rgba(255, 215, 0, 0.3); --element-bg: linear-gradient(135deg, #ffd700, #ff8f00);" onclick="startGame('weaving')">
                <div class="game-card-header">
                    <div class="game-icon">‚ú®</div>
                    <div class="game-info">
                        <h3>Reality Weaving</h3>
                        <p>Manifest Your Vision</p>
                    </div>
                </div>
                <div class="game-card-content">
                    <p class="game-description">
                        The ultimate creative sandbox. Combine agents, skills, and elements to manifest complex creations and track your manifestations.
                    </p>
                    <div class="game-stats-bar">
                        <span>üåü Master Only</span>
                        <span>üé® Unlimited</span>
                        <span>üí´ 28 Manifestations</span>
                    </div>
                    <div class="game-progress">
                        <div class="progress-header">
                            <span>Creative Power</span>
                            <span>85%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 85%;"></div>
                        </div>
                    </div>
                    <button class="play-btn">Weave Reality</button>
                </div>
            </div>

            <!-- PREMIUM GAMES SECTION -->
            <div style="grid-column: 1 / -1; margin: 2rem 0 1rem;">
                <h2 style="font-family: 'Cinzel', serif; font-size: 1.5rem; color: var(--gold-light); text-align: center;">
                    ‚öîÔ∏è Premium Game Suite ‚öîÔ∏è
                </h2>
                <p style="text-align: center; color: var(--text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">
                    AAA-quality games powered by Phaser.js
                </p>
            </div>

            <!-- Forge Master -->
            <div class="game-card" style="--element-color: var(--fire-primary); --element-glow: rgba(255, 107, 53, 0.3); --element-bg: linear-gradient(135deg, #ff6b35, #ff9e6d);" onclick="window.location.href='games/forge-master.html'">
                <div class="game-card-header">
                    <div class="game-icon">‚öíÔ∏è</div>
                    <div class="game-info">
                        <h3>Forge Master</h3>
                        <p>Craft Legendary Items</p>
                    </div>
                </div>
                <div class="game-card-content">
                    <p class="game-description">
                        Master the art of blacksmithing. Gather materials, heat your forge, and craft weapons of legendary quality. Each creation earns XP based on craftsmanship.
                    </p>
                    <div class="game-stats-bar">
                        <span>üî• Fire Element</span>
                        <span>‚öíÔ∏è Crafting</span>
                        <span>NEW</span>
                    </div>
                    <div class="game-progress">
                        <div class="progress-header">
                            <span>Game Status</span>
                            <span>‚úÖ Live</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 100%;"></div>
                        </div>
                    </div>
                    <button class="play-btn">Enter Forge</button>
                </div>
            </div>

            <!-- Phoenix Rising -->
            <div class="game-card" style="--element-color: var(--fire-primary); --element-glow: rgba(255, 107, 53, 0.3); --element-bg: linear-gradient(135deg, #ff6b35, #ff9e6d);" onclick="window.location.href='games/phoenix-rising.html'">
                <div class="game-card-header">
                    <div class="game-icon">ü¶Ö</div>
                    <div class="game-info">
                        <h3>Phoenix Rising</h3>
                        <p>Roguelike Dungeon Crawler</p>
                    </div>
                </div>
                <div class="game-card-content">
                    <p class="game-description">
                        Descend into procedurally generated dungeons. Fight enemies, collect loot, and rise from death stronger. Features permadeath with meta-progression.
                    </p>
                    <div class="game-stats-bar">
                        <span>üî• Fire Element</span>
                        <span>‚öîÔ∏è Combat</span>
                        <span>NEW</span>
                    </div>
                    <div class="game-progress">
                        <div class="progress-header">
                            <span>Game Status</span>
                            <span>‚úÖ Live</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 100%;"></div>
                        </div>
                    </div>
                    <button class="play-btn">Enter Dungeon</button>
                </div>
            </div>

            <!-- River Flow -->
            <div class="game-card" style="--element-color: var(--water-primary); --element-glow: rgba(79, 195, 247, 0.3); --element-bg: linear-gradient(135deg, #4fc3f7, #80d8ff);" onclick="window.location.href='games/river-flow.html'">
                <div class="game-card-header">
                    <div class="game-icon">üåä</div>
                    <div class="game-info">
                        <h3>River Flow</h3>
                        <p>Puzzle Strategy</p>
                    </div>
                </div>
                <div class="game-card-content">
                    <p class="game-description">
                        Redirect water flows through ancient aqueducts. Rotate pipes to connect the flow and unlock emotional narratives. 50+ levels with branching storylines.
                    </p>
                    <div class="game-stats-bar">
                        <span>üíß Water Element</span>
                        <span>üß© Puzzle</span>
                        <span>NEW</span>
                    </div>
                    <div class="game-progress">
                        <div class="progress-header">
                            <span>Game Status</span>
                            <span>‚úÖ Live</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 100%;"></div>
                        </div>
                    </div>
                    <button class="play-btn">Flow the River</button>
                </div>
            </div>

            <!-- Ocean Memory -->
            <div class="game-card" style="--element-color: var(--water-primary); --element-glow: rgba(79, 195, 247, 0.3); --element-bg: linear-gradient(135deg, #4fc3f7, #80d8ff);" onclick="window.location.href='games/ocean-memory.html'">
                <div class="game-card-header">
                    <div class="game-icon">üêã</div>
                    <div class="game-info">
                        <h3>Ocean Memory</h3>
                        <p>Exploration Adventure</p>
                    </div>
                </div>
                <div class="game-card-content">
                    <p class="game-description">
                        Explore deep sea environments and collect memory fragments. Discover ancient ruins, unlock hidden lore, and uncover the secrets of the Arcanea world.
                    </p>
                    <div class="game-stats-bar">
                        <span>üíß Water Element</span>
                        <span>üêã Exploration</span>
                        <span>NEW</span>
                    </div>
                    <div class="game-progress">
                        <div class="progress-header">
                            <span>Game Status</span>
                            <span>‚úÖ Live</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 100%;"></div>
                        </div>
                    </div>
                    <button class="play-btn">Dive Deep</button>
                </div>
            </div>

            <!-- Crystal Architect -->
            <div class="game-card" style="--element-color: var(--earth-primary); --element-glow: rgba(141, 110, 99, 0.3); --element-bg: linear-gradient(135deg, #8d6e63, #bcaaa4);" onclick="window.location.href='games/crystal-architect.html'">
                <div class="game-card-header">
                    <div class="game-icon">üíé</div>
                    <div class="game-info">
                        <h3>Crystal Architect</h3>
                        <p>Building & Physics</p>
                    </div>
                </div>
                <div class="game-card-content">
                    <p class="game-description">
                        Build magnificent structures with physics-based stability challenges. Place blocks strategically, test structural integrity, and create architectural masterpieces.
                    </p>
                    <div class="game-stats-bar">
                        <span>üåç Earth Element</span>
                        <span>üèóÔ∏è Building</span>
                        <span>NEW</span>
                    </div>
                    <div class="game-progress">
                        <div class="progress-header">
                            <span>Game Status</span>
                            <span>‚úÖ Live</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 100%;"></div>
                        </div>
                    </div>
                    <button class="play-btn">Build Structure</button>
                </div>
            </div>

            <!-- Mountain Builder -->
            <div class="game-card" style="--element-color: var(--earth-primary); --element-glow: rgba(141, 110, 99, 0.3); --element-bg: linear-gradient(135deg, #8d6e63, #bcaaa4);" onclick="window.location.href='games/mountain-builder.html'">
                <div class="game-card-header">
                    <div class="game-icon">‚õ∞Ô∏è</div>
                    <div class="game-info">
                        <h3>Mountain Builder</h3>
                        <p>Idle/Incremental</p>
                    </div>
                </div>
                <div class="game-card-content">
                    <p class="game-description">
                        Build a mountain civilization over time. Mine resources, craft tools, and expand your settlement. Progress continues even when you're away!
                    </p>
                    <div class="game-stats-bar">
                        <span>üåç Earth Element</span>
                        <span>‚õèÔ∏è Idle</span>
                        <span>NEW</span>
                    </div>
                    <div class="game-progress">
                        <div class="progress-header">
                            <span>Game Status</span>
                            <span>‚úÖ Live</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 100%;"></div>
                        </div>
                    </div>
                    <button class="play-btn">Start Mining</button>
                </div>
            </div>

            <!-- Storm Scribe -->
            <div class="game-card" style="--element-color: var(--wind-primary); --element-glow: rgba(179, 157, 219, 0.3); --element-bg: linear-gradient(135deg, #b39ddb, #d1c4e9);" onclick="window.location.href='games/storm-scribe.html'">
                <div class="game-card-header">
                    <div class="game-icon">üå™Ô∏è</div>
                    <div class="game-info">
                        <h3>Storm Scribe</h3>
                        <p>Typing Challenge</p>
                    </div>
                </div>
                <div class="game-card-content">
                    <p class="game-description">
                        Fast-paced typing challenges with creative prompts. Race against time, improve your WPM and accuracy, and master the art of written communication.
                    </p>
                    <div class="game-stats-bar">
                        <span>üí® Wind Element</span>
                        <span>‚å®Ô∏è Typing</span>
                        <span>NEW</span>
                    </div>
                    <div class="game-progress">
                        <div class="progress-header">
                            <span>Game Status</span>
                            <span>‚úÖ Live</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 100%;"></div>
                        </div>
                    </div>
                    <button class="play-btn">Start Typing</button>
                </div>
            </div>

            <!-- Cloud Navigator -->
            <div class="game-card" style="--element-color: var(--wind-primary); --element-glow: rgba(179, 157, 219, 0.3); --element-bg: linear-gradient(135deg, #b39ddb, #d1c4e9);" onclick="window.location.href='games/cloud-navigator.html'">
                <div class="game-card-header">
                    <div class="game-icon">‚òÅÔ∏è</div>
                    <div class="game-info">
                        <h3>Cloud Navigator</h3>
                        <p>Platformer Adventure</p>
                    </div>
                </div>
                <div class="game-card-content">
                    <p class="game-description">
                        Navigate floating islands using wind currents. Glide between clouds, collect artifacts, and explore the sky kingdom. Master the art of aerial movement.
                    </p>
                    <div class="game-stats-bar">
                        <span>üí® Wind Element</span>
                        <span>‚òÅÔ∏è Platformer</span>
                        <span>NEW</span>
                    </div>
                    <div class="game-progress">
                        <div class="progress-header">
                            <span>Game Status</span>
                            <span>‚úÖ Live</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 100%;"></div>
                        </div>
                    </div>
                    <button class="play-btn">Take Flight</button>
                </div>
            </div>

            <!-- Void Gazer -->
            <div class="game-card" style="--element-color: var(--void-primary); --element-glow: rgba(124, 77, 255, 0.3); --element-bg: linear-gradient(135deg, #7c4dff, #b388ff);" onclick="window.location.href='games/void-gazer.html'">
                <div class="game-card-header">
                    <div class="game-icon">üåë</div>
                    <div class="game-info">
                        <h3>Void Gazer</h3>
                        <p>Mystery Puzzle</p>
                    </div>
                </div>
                <div class="game-card-content">
                    <p class="game-description">
                        Uncover hidden patterns in the void. Test your memory with symbol sequences, decode mysteries, and prove your perception mastery to the cosmos.
                    </p>
                    <div class="game-stats-bar">
                        <span>‚ö´ Void Element</span>
                        <span>üîÆ Mystery</span>
                        <span>NEW</span>
                    </div>
                    <div class="game-progress">
                        <div class="progress-header">
                            <span>Game Status</span>
                            <span>‚úÖ Live</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 100%;"></div>
                        </div>
                    </div>
                    <button class="play-btn">Gaze Into Void</button>
                </div>
            </div>

            <!-- Quantum Designer -->
            <div class="game-card" style="--element-color: var(--void-primary); --element-glow: rgba(124, 77, 255, 0.3); --element-bg: linear-gradient(135deg, #7c4dff, #b388ff);" onclick="window.location.href='games/quantum-designer.html'">
                <div class="game-card-header">
                    <div class="game-icon">‚öõÔ∏è</div>
                    <div class="game-info">
                        <h3>Quantum Designer</h3>
                        <p>Strategy Simulation</p>
                    </div>
                </div>
                <div class="game-card-content">
                    <p class="game-description">
                        Manage multiple timelines simultaneously. Balance resources across parallel realities, merge timelines for power bonuses, and master multi-dimensional strategy.
                    </p>
                    <div class="game-stats-bar">
                        <span>‚ö´ Void Element</span>
                        <span>‚öõÔ∏è Strategy</span>
                        <span>NEW</span>
                    </div>
                    <div class="game-progress">
                        <div class="progress-header">
                            <span>Game Status</span>
                            <span>‚úÖ Live</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 100%;"></div>
                        </div>
                    </div>
                    <button class="play-btn">Design Reality</button>
                </div>
            </div>
        </div>

        <!-- Elemental Challenges Arena -->
        <div class="game-arena" id="challengesArena">
            <div class="arena-header">
                <h2 class="arena-title"><span>üî•</span> Elemental Challenges</h2>
                <button class="back-btn" onclick="backToMenu()">‚Üê Back to Games</button>
            </div>

            <div class="challenges-container">
                <div class="towers-grid">
                    <div class="element-tower active" data-element="fire" style="--element-color: var(--fire-primary); --element-glow: rgba(255, 107, 53, 0.5);" onclick="selectTower('fire')">
                        <div class="tower-icon">üî•</div>
                        <div class="tower-name" style="color: var(--fire-primary);">Fire Tower</div>
                        <div class="tower-progress">3 / 10 Completed</div>
                        <div class="tower-xp">1,500 XP earned</div>
                        <div class="progress-bar-tower">
                            <div class="progress-fill-tower" style="width: 30%;"></div>
                        </div>
                    </div>

                    <div class="element-tower" data-element="water" style="--element-color: var(--water-primary); --element-glow: rgba(79, 195, 247, 0.5);" onclick="selectTower('water')">
                        <div class="tower-icon">üíß</div>
                        <div class="tower-name" style="color: var(--water-primary);">Water Tower</div>
                        <div class="tower-progress">2 / 10 Completed</div>
                        <div class="tower-xp">1,000 XP earned</div>
                        <div class="progress-bar-tower">
                            <div class="progress-fill-tower" style="width: 20%;"></div>
                        </div>
                    </div>

                    <div class="element-tower" data-element="earth" style="--element-color: var(--earth-primary); --element-glow: rgba(141, 110, 99, 0.5);" onclick="selectTower('earth')">
                        <div class="tower-icon">üåç</div>
                        <div class="tower-name" style="color: var(--earth-primary);">Earth Tower</div>
                        <div class="tower-progress">5 / 10 Completed</div>
                        <div class="tower-xp">2,500 XP earned</div>
                        <div class="progress-bar-tower">
                            <div class="progress-fill-tower" style="width: 50%;"></div>
                        </div>
                    </div>

                    <div class="element-tower" data-element="wind" style="--element-color: var(--wind-primary); --element-glow: rgba(179, 157, 219, 0.5);" onclick="selectTower('wind')">
                        <div class="tower-icon">üí®</div>
                        <div class="tower-name" style="color: var(--wind-primary);">Wind Tower</div>
                        <div class="tower-progress">1 / 10 Completed</div>
                        <div class="tower-xp">500 XP earned</div>
                        <div class="progress-bar-tower">
                            <div class="progress-fill-tower" style="width: 10%;"></div>
                        </div>
                    </div>

                    <div class="element-tower locked" data-element="void" style="--element-color: var(--void-primary); --element-glow: rgba(124, 77, 255, 0.5);">
                        <div class="tower-icon">‚ö´</div>
                        <div class="tower-name" style="color: var(--void-primary);">Void Tower</div>
                        <div class="tower-progress">üîí Complete 4 Towers</div>
                        <div class="tower-xp">0 XP earned</div>
                        <div class="progress-bar-tower">
                            <div class="progress-fill-tower" style="width: 0%;"></div>
                        </div>
                    </div>
                </div>

                <div class="challenges-list" id="challengesList">
                    <h3><span style="font-size: 1.5rem;">üî•</span> Fire Tower Challenges</h3>
                    <!-- Challenges will be dynamically populated -->
                </div>

                <div class="active-challenge" id="activeChallenge" style="display: none;">
                    <div class="challenge-header">
                        <div class="challenge-title-section">
                            <h3 id="activeChallengeTitle">Fire Challenge #4: The Phoenix Rises</h3>
                            <span class="difficulty-badge difficulty-medium">Medium</span>
                        </div>
                        <div class="challenge-timer" id="challengeTimer">‚è±Ô∏è 14:32</div>
                    </div>
                    <div class="challenge-description" id="activeChallengeDescription">
                        Transformation requires courage. Create something that completely reimagines an existing concept, burning away the old to reveal something new and powerful.
                    </div>
                    <div class="challenge-task-box">
                        <div class="task-label">Your Task</div>
                        <div class="task-content" id="activeTaskContent">
                            Take a common object from daily life and reimagine it as something from a fantasy world. Describe its new form, function, and the magic it possesses. Minimum 100 words.
                        </div>
                        <textarea class="challenge-input" id="challengeInput" placeholder="Enter your creative response here..."></textarea>
                    </div>
                    <div class="challenge-actions">
                        <button class="btn btn-secondary" onclick="skipChallenge()">Skip Challenge</button>
                        <button class="btn btn-primary" onclick="completeChallenge()">Complete Challenge</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Agent Summoning Arena -->
        <div class="game-arena" id="summoningArena">
            <div class="arena-header">
                <h2 class="arena-title"><span>üë•</span> Agent Summoning Circle</h2>
                <button class="back-btn" onclick="backToMenu()">‚Üê Back to Games</button>
            </div>

            <div class="summoning-arena">
                <div class="summoning-stage">
                    <div class="summoning-circle">
                        <div class="outer-ring"></div>
                        <div class="middle-ring"></div>
                        <div class="inner-ring"></div>
                        <div class="core-symbol" id="summoningCore">‚ú®</div>
                    </div>
                    <div class="summoning-status" id="summoningStatus">Select an agent to begin the ritual</div>
                </div>

                <div class="agent-grid" id="agentGrid">
                    <!-- Agents will be dynamically populated -->
                </div>

                <button class="btn btn-primary summon-btn" id="summonBtn" onclick="beginSummoning()" disabled>
                    ‚ú® Begin Summoning Ritual ‚ú®
                </button>
            </div>
        </div>

        <!-- Skill Mastery Arena -->
        <div class="game-arena" id="masteryArena">
            <div class="arena-header">
                <h2 class="arena-title"><span>‚öîÔ∏è</span> Skill Mastery</h2>
                <button class="back-btn" onclick="backToMenu()">‚Üê Back to Games</button>
            </div>

            <div class="mastery-arena">
                <div class="mastery-stats">
                    <div class="mastery-stat-card">
                        <div class="mastery-stat-label">Current Rank</div>
                        <div class="mastery-stat-value">Adept</div>
                    </div>
                    <div class="mastery-stat-card">
                        <div class="mastery-stat-label">Level</div>
                        <div class="mastery-stat-value">7</div>
                    </div>
                    <div class="mastery-stat-card">
                        <div class="mastery-stat-label">XP to Master</div>
                        <div class="mastery-stat-value">2,340</div>
                    </div>
                    <div class="mastery-stat-card">
                        <div class="mastery-stat-label">Skills Mastered</div>
                        <div class="mastery-stat-value">23</div>
                    </div>
                </div>

                <div class="skill-categories">
                    <div class="category-tab active" data-category="all" onclick="filterSkills('all')">All Skills</div>
                    <div class="category-tab" data-category="fire" onclick="filterSkills('fire')">üî• Fire</div>
                    <div class="category-tab" data-category="water" onclick="filterSkills('water')">üíß Water</div>
                    <div class="category-tab" data-category="earth" onclick="filterSkills('earth')">üåç Earth</div>
                    <div class="category-tab" data-category="wind" onclick="filterSkills('wind')">üí® Wind</div>
                    <div class="category-tab" data-category="void" onclick="filterSkills('void')">‚ö´ Void</div>
                </div>

                <div class="skills-grid" id="skillsGrid">
                    <!-- Skills will be dynamically populated -->
                </div>
            </div>
        </div>

        <!-- Reality Weaving Arena -->
        <div class="game-arena" id="weavingArena">
            <div class="arena-header">
                <h2 class="arena-title"><span>‚ú®</span> Reality Weaving Studio</h2>
                <button class="back-btn" onclick="backToMenu()">‚Üê Back to Games</button>
            </div>

            <div class="weaving-arena">
                <div class="weaving-workspace">
                    <div class="weaving-panel">
                        <h3 class="panel-title">üé® Weaving Canvas</h3>
                        
                        <div style="margin-bottom: 1rem;">
                            <label style="display: block; font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Selected Agents</label>
                            <div class="selected-agents" id="selectedAgents">
                                <span style="color: var(--text-muted); font-size: 0.875rem;">Click agents below to add them to your weave</span>
                            </div>
                        </div>

                        <div style="margin-bottom: 1.5rem;">
                            <label style="display: block; font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Available Agents</label>
                            <div class="agent-pool" id="agentPool">
                                <!-- Will be populated dynamically -->
                            </div>
                        </div>

                        <div style="margin-bottom: 1.5rem;">
                            <label style="display: block; font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Your Intention</label>
                            <textarea class="intention-input" id="weavingIntention" placeholder="Describe what you wish to manifest..."></textarea>
                        </div>

                        <button class="btn btn-primary weave-btn" onclick="weaveReality()">‚ú® Weave Reality ‚ú®</button>
                    </div>

                    <div class="weaving-panel">
                        <h3 class="panel-title">üåü Manifestation Log</h3>
                        <div class="manifestation-log" id="manifestationLog">
                            <!-- Will be populated dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal-overlay" id="successModal">
        <div class="success-modal">
            <div class="success-icon">üéâ</div>
            <h3 class="success-title" id="modalTitle">Challenge Complete!</h3>
            <p class="success-message" id="modalMessage">You have successfully demonstrated mastery of Fire transformation.</p>
            <div class="rewards-container">
                <div class="reward-item">
                    <div class="reward-icon">‚≠ê</div>
                    <div class="reward-value" id="modalXP">+500 XP</div>
                    <div class="reward-label">Experience</div>
                </div>
                <div class="reward-item">
                    <div class="reward-icon">üèÜ</div>
                    <div class="reward-value" id="modalBadge">Fire Badge</div>
                    <div class="reward-label">Achievement</div>
                </div>
                <div class="reward-item">
                    <div class="reward-icon">üíé</div>
                    <div class="reward-value">+10</div>
                    <div class="reward-label">Essence</div>
                </div>
            </div>
            <button class="btn btn-primary" onclick="closeModal()">Continue</button>
        </div>
    </div>

    <script>
        // Game State
        const gameState = {
            player: {
                level: 7,
                xp: 47832,
                totalXP: 47832,
                agentsSummoned: 12,
                skillsMastered: 23,
                completedChallenges: 11,
                manifestations: 28
            },
            currentTower: 'fire',
            selectedAgent: null,
            selectedAgentsForWeaving: [],
            challenges: {
                fire: [
                    { id: 1, name: "The First Spark", difficulty: "easy", xp: 100, completed: true, description: "Create a simple transformation. Change one small thing into something new." },
                    { id: 2, name: "Burning Bright", difficulty: "easy", xp: 150, completed: true, description: "Add passion to a piece of writing. Infuse it with emotional fire." },
                    { id: 3, name: "The Catalyst", difficulty: "medium", xp: 250, completed: true, description: "Accelerate a project's timeline without sacrificing quality." },
                    { id: 4, name: "The Phoenix Rises", difficulty: "medium", xp: 500, completed: false, description: "Completely reimagine an existing concept from scratch." },
                    { id: 5, name: "Forge Master", difficulty: "hard", xp: 750, completed: false, description: "Create something under intense constraints that thrives because of them." },
                    { id: 6, name: "Inferno", difficulty: "hard", xp: 1000, completed: false, description: "Maintain peak creative output for a full day." },
                    { id: 7, name: "Dragon's Breath", difficulty: "legendary", xp: 2000, completed: false, description: "Transform a failed project into a masterpiece." },
                ],
                water: [
                    { id: 1, name: "First Flow", difficulty: "easy", xp: 100, completed: true, description: "Write without stopping for 15 minutes." },
                    { id: 2, name: "Emotional Current", difficulty: "easy", xp: 150, completed: true, description: "Express a complex feeling through metaphor." },
                ],
                earth: [
                    { id: 1, name: "Foundation Stone", difficulty: "easy", xp: 100, completed: true, description: "Create a solid project plan with milestones." },
                    { id: 2, name: "Crystal Clarity", difficulty: "easy", xp: 150, completed: true, description: "Organize a chaotic workspace or file system." },
                    { id: 3, name: "Mountain Patience", difficulty: "medium", xp: 250, completed: true, description: "Work on a single project for 4 hours without distraction." },
                    { id: 4, name: "Earth Wisdom", difficulty: "medium", xp: 500, completed: true, description: "Teach someone else a skill you've mastered." },
                    { id: 5, name: "Gemcutter", difficulty: "medium", xp: 500, completed: true, description: "Refine a rough draft into polished work." },
                ],
                wind: [
                    { id: 1, name: "First Words", difficulty: "easy", xp: 100, completed: true, description: "Share your work with one other person." },
                ],
                void: [
                    // Locked until other towers completed
                ]
            },
            agents: [
                { id: 'dragon-forge', name: 'Dragon-Forge', element: 'fire', icon: 'üêâ', summoned: true, bonded: true },
                { id: 'phoenix-artisan', name: 'Phoenix-Artisan', element: 'fire', icon: 'üî•', summoned: true, bonded: false },
                { id: 'volcano-sculptor', name: 'Volcano-Sculptor', element: 'fire', icon: 'üåã', summoned: false, bonded: false },
                { id: 'river-storyteller', name: 'River-Story', element: 'water', icon: 'üåä', summoned: true, bonded: true },
                { id: 'ocean-memory', name: 'Ocean-Memory', element: 'water', icon: 'üåä', summoned: true, bonded: false },
                { id: 'crystal-architect', name: 'Crystal-Arch', element: 'earth', icon: 'üíé', summoned: true, bonded: true },
                { id: 'mountain-builder', name: 'Mountain-Builder', element: 'earth', icon: 'üèîÔ∏è', summoned: true, bonded: false },
                { id: 'void-gazer', name: 'Void-Gazer', element: 'void', icon: 'üëÅÔ∏è', summoned: true, bonded: true },
                // Add more agents...
            ],
            skills: [
                { id: 'ignite', name: 'Ignition.Spark', element: 'fire', level: 5, xp: 2500, maxXP: 5000, icon: 'üî•', description: 'Initiate creative projects with intense energy' },
                { id: 'transmute', name: 'Transformation.Alchemy', element: 'fire', level: 4, xp: 3800, maxXP: 5000, icon: '‚öóÔ∏è', description: 'Convert base materials into golden masterpieces' },
                { id: 'flow', name: 'Flow.Channel', element: 'water', level: 4, xp: 3200, maxXP: 5000, icon: 'üåä', description: 'Direct creative energy into productive streams' },
                { id: 'emotion', name: 'Emotion.Alchemy', element: 'water', level: 3, xp: 2100, maxXP: 3000, icon: 'üíù', description: 'Transform feelings into artistic expression' },
                { id: 'foundation', name: 'Foundation.Stone', element: 'earth', level: 5, xp: 4800, maxXP: 5000, icon: 'üóø', description: 'Create unshakeable creative foundations' },
                { id: 'structure', name: 'Structure.Architect', element: 'earth', level: 4, xp: 3900, maxXP: 5000, icon: 'üèõÔ∏è', description: 'Design robust frameworks and architectures' },
                { id: 'voice', name: 'Voice.Clarion', element: 'wind', level: 4, xp: 3500, maxXP: 5000, icon: 'üì¢', description: 'Speak with unmistakable clarity and power' },
                { id: 'vision', name: 'Vision.Infinite', element: 'void', level: 5, xp: 4900, maxXP: 5000, icon: 'üëÅÔ∏è', description: 'See beyond current reality into possibility' },
                // Add more skills...
            ],
            manifestations: [
                { id: 1, title: 'Epic Fantasy World', agents: ['Dragon-Forge', 'River-Story', 'Void-Gazer'], timestamp: Date.now() - 86400000 },
                { id: 2, title: 'Character Arc', agents: ['Phoenix-Artisan', 'Ocean-Memory'], timestamp: Date.now() - 172800000 },
                { id: 3, title: 'Technical Architecture', agents: ['Crystal-Arch', 'Mountain-Builder'], timestamp: Date.now() - 259200000 },
            ]
        };

        // Generate stars
        function generateStars() {
            const cosmicBg = document.querySelector('.cosmic-bg');
            for (let i = 0; i < 80; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 4 + 's';
                cosmicBg.appendChild(star);
            }
        }

        // Game Navigation
        function startGame(game) {
            document.getElementById('gameMenu').style.display = 'none';
            document.querySelectorAll('.game-arena').forEach(arena => {
                arena.classList.remove('active');
            });

            const arenaId = game + 'Arena';
            const arena = document.getElementById(arenaId);
            if (arena) {
                arena.classList.add('active');
                
                // Initialize specific game
                if (game === 'challenges') {
                    loadChallenges(gameState.currentTower);
                } else if (game === 'summoning') {
                    loadAgents();
                } else if (game === 'mastery') {
                    loadSkills('all');
                } else if (game === 'weaving') {
                    loadWeavingAgents();
                    loadManifestations();
                }
            }
        }

        function backToMenu() {
            document.querySelectorAll('.game-arena').forEach(arena => {
                arena.classList.remove('active');
            });
            document.getElementById('gameMenu').style.display = 'grid';
        }

        // Elemental Challenges Functions
        function selectTower(element) {
            if (element === 'void' && !isVoidUnlocked()) {
                return;
            }

            gameState.currentTower = element;
            
            // Update UI
            document.querySelectorAll('.element-tower').forEach(tower => {
                tower.classList.remove('active');
            });
            document.querySelector(`[data-element="${element}"]`).classList.add('active');

            loadChallenges(element);
        }

        function isVoidUnlocked() {
            // Check if all other towers have at least some progress
            return false; // Locked for now
        }

        function loadChallenges(element) {
            const container = document.getElementById('challengesList');
            const elementData = {
                fire: { icon: 'üî•', name: 'Fire' },
                water: { icon: 'üíß', name: 'Water' },
                earth: { icon: 'üåç', name: 'Earth' },
                wind: { icon: 'üí®', name: 'Wind' },
                void: { icon: '‚ö´', name: 'Void' }
            };
            
            const data = elementData[element];
            const challenges = gameState.challenges[element] || [];

            let html = `<h3><span style="font-size: 1.5rem;">${data.icon}</span> ${data.name} Tower Challenges</h3>`;
            
            challenges.forEach(challenge => {
                const difficultyClass = `difficulty-${challenge.difficulty}`;
                const statusClass = challenge.completed ? 'completed' : 'available';
                const statusIcon = challenge.completed ? '‚úì' : challenge.id === 4 ? '‚ñ∂' : 'üîí';
                
                html += `
                    <div class="challenge-item ${statusClass}" onclick="startChallenge('${element}', ${challenge.id})">
                        <div class="challenge-info">
                            <h4 class="challenge-name">${challenge.name}</h4>
                            <div class="challenge-meta">
                                <span class="difficulty-badge ${difficultyClass}">${challenge.difficulty}</span>
                                <span>${challenge.completed ? 'Completed' : challenge.id === 4 ? 'Available' : 'Locked'}</span>
                            </div>
                        </div>
                        <div class="challenge-reward">
                            <div class="reward-xp">+${challenge.xp} XP</div>
                            <div class="reward-label">${challenge.completed ? 'Earned' : 'Reward'}</div>
                        </div>
                        <div class="challenge-status status-${statusClass}">${statusIcon}</div>
                    </div>
                `;
            });

            container.innerHTML = html;
            
            // Hide active challenge
            document.getElementById('activeChallenge').style.display = 'none';
        }

        let activeChallengeTimer = null;
        let challengeTimeRemaining = 900; // 15 minutes

        function startChallenge(element, challengeId) {
            const challenge = gameState.challenges[element].find(c => c.id === challengeId);
            if (!challenge || challenge.completed) return;

            document.getElementById('activeChallenge').style.display = 'block';
            document.getElementById('activeChallengeTitle').textContent = `${challenge.name}`;
            document.getElementById('activeChallengeDescription').textContent = challenge.description;
            document.getElementById('activeTaskContent').textContent = challenge.task || challenge.description;
            document.getElementById('challengeInput').value = '';

            // Start timer
            challengeTimeRemaining = 900;
            if (activeChallengeTimer) clearInterval(activeChallengeTimer);
            activeChallengeTimer = setInterval(updateChallengeTimer, 1000);
            
            // Scroll to challenge
            document.getElementById('activeChallenge').scrollIntoView({ behavior: 'smooth' });
        }

        function updateChallengeTimer() {
            challengeTimeRemaining--;
            const minutes = Math.floor(challengeTimeRemaining / 60);
            const seconds = challengeTimeRemaining % 60;
            document.getElementById('challengeTimer').textContent = `‚è±Ô∏è ${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            if (challengeTimeRemaining <= 0) {
                clearInterval(activeChallengeTimer);
                skipChallenge();
            }
        }

        function completeChallenge() {
            const input = document.getElementById('challengeInput').value;
            if (input.trim().length < 20) {
                alert('Please provide a more detailed response (at least 20 characters) to complete this challenge.');
                return;
            }

            clearInterval(activeChallengeTimer);
            
            // Find the active challenge and complete it
            const challenges = gameState.challenges[gameState.currentTower];
            const activeChallenge = challenges.find(c => !c.completed && c.id === 4); // Simplified
            
            if (activeChallenge) {
                activeChallenge.completed = true;
                gameState.player.xp += activeChallenge.xp;
                gameState.player.totalXP += activeChallenge.xp;
                gameState.player.completedChallenges++;
                
                showModal(
                    'Challenge Complete!',
                    `You have successfully demonstrated mastery of ${gameState.currentTower} element.`,
                    `+${activeChallenge.xp} XP`,
                    `${gameState.currentTower.charAt(0).toUpperCase() + gameState.currentTower.slice(1)} Badge`
                );
                
                updatePlayerStats();
                loadChallenges(gameState.currentTower);
            }
        }

        function skipChallenge() {
            clearInterval(activeChallengeTimer);
            document.getElementById('activeChallenge').style.display = 'none';
        }

        // Agent Summoning Functions
        function loadAgents() {
            const grid = document.getElementById('agentGrid');
            const elementColors = {
                fire: '#ff6b35',
                water: '#4fc3f7',
                earth: '#8d6e63',
                wind: '#b39ddb',
                void: '#7c4dff'
            };

            let html = '';
            gameState.agents.forEach(agent => {
                const statusClass = agent.summoned ? 'summoned' : '';
                const lockedClass = !agent.summoned && gameState.player.level < 5 ? 'locked' : '';
                
                html += `
                    <div class="agent-token ${statusClass} ${lockedClass}" 
                         style="--element-color: ${elementColors[agent.element]};"
                         onclick="selectAgentForSummoning('${agent.id}')">
                        <div class="token-icon">${agent.icon}</div>
                        <div class="token-name">${agent.name}</div>
                        <div class="token-element">${agent.element}</div>
                    </div>
                `;
            });

            grid.innerHTML = html;
        }

        function selectAgentForSummoning(agentId) {
            const agent = gameState.agents.find(a => a.id === agentId);
            if (!agent || agent.summoned) return;

            gameState.selectedAgent = agent;
            
            // Update UI
            document.querySelectorAll('.agent-token').forEach(token => {
                token.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');

            document.getElementById('summoningCore').textContent = agent.icon;
            document.getElementById('summoningStatus').textContent = `${agent.name} awaits your call. Begin the ritual when ready.`;
            document.getElementById('summonBtn').disabled = false;
        }

        function beginSummoning() {
            if (!gameState.selectedAgent) return;

            const core = document.getElementById('summoningCore');
            const status = document.getElementById('summoningStatus');
            const btn = document.getElementById('summonBtn');

            btn.disabled = true;
            status.textContent = 'The ritual begins... Concentrate your intention...';
            
            // Animation sequence
            setTimeout(() => {
                core.style.animation = 'pulse 0.5s ease-in-out infinite';
                status.textContent = 'The circle pulses with energy...';
            }, 1000);

            setTimeout(() => {
                status.textContent = 'A presence approaches from beyond...';
            }, 3000);

            setTimeout(() => {
                core.style.fontSize = '7rem';
                status.textContent = `${gameState.selectedAgent.name} has answered your call!`;
            }, 5000);

            setTimeout(() => {
                // Mark as summoned
                gameState.selectedAgent.summoned = true;
                gameState.player.agentsSummoned++;
                
                showModal(
                    'Agent Summoned!',
                    `${gameState.selectedAgent.name} has joined your council and is ready to assist you.`,
                    '+1000 XP',
                    'New Ally'
                );
                
                updatePlayerStats();
                loadAgents();
                
                // Reset
                core.style.fontSize = '5rem';
                core.style.animation = 'pulse 2s ease-in-out infinite';
                document.getElementById('summoningCore').textContent = '‚ú®';
                document.getElementById('summoningStatus').textContent = 'Select an agent to begin the ritual';
                gameState.selectedAgent = null;
            }, 6500);
        }

        // Skill Mastery Functions
        function loadSkills(category) {
            const grid = document.getElementById('skillsGrid');
            
            // Filter skills
            let skills = gameState.skills;
            if (category !== 'all') {
                skills = skills.filter(s => s.element === category);
            }

            let html = '';
            skills.forEach(skill => {
                const elementColors = {
                    fire: '#ff6b35',
                    water: '#4fc3f7',
                    earth: '#8d6e63',
                    wind: '#b39ddb',
                    void: '#7c4dff'
                };
                
                const progressPercent = (skill.xp / skill.maxXP) * 100;
                
                html += `
                    <div class="skill-card" onclick="trainSkill('${skill.id}')" style="--element-color: ${elementColors[skill.element]};">
                        <div class="skill-header">
                            <div class="skill-icon" style="background: ${elementColors[skill.element]};">${skill.icon}</div>
                            <div class="skill-level">Lvl ${skill.level}</div>
                        </div>
                        <div class="skill-name">${skill.name}</div>
                        <div class="skill-description">${skill.description}</div>
                        <div class="skill-progress">
                            <div class="skill-progress-bar" style="width: ${progressPercent}%;"></div>
                        </div>
                        <div class="skill-xp">${skill.xp} / ${skill.maxXP} XP</div>
                    </div>
                `;
            });

            grid.innerHTML = html;
        }

        function filterSkills(category) {
            // Update tabs
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-category="${category}"]`).classList.add('active');
            
            loadSkills(category);
        }

        function trainSkill(skillId) {
            const skill = gameState.skills.find(s => s.id === skillId);
            if (!skill) return;

            // Simulate training
            const xpGain = Math.floor(Math.random() * 200) + 100;
            skill.xp += xpGain;
            gameState.player.xp += xpGain;
            gameState.player.totalXP += xpGain;

            // Check for level up
            if (skill.xp >= skill.maxXP && skill.level < 10) {
                skill.level++;
                skill.xp = skill.xp - skill.maxXP;
                skill.maxXP = skill.level * 1000;
                
                showModal(
                    'Skill Level Up!',
                    `${skill.name} has reached Level ${skill.level}!`,
                    `+${xpGain} XP`,
                    'Level Up!'
                );
            } else {
                // Just show XP gain
                alert(`Training complete! +${xpGain} XP added to ${skill.name}`);
            }

            updatePlayerStats();
            loadSkills(document.querySelector('.category-tab.active').dataset.category);
        }

        // Reality Weaving Functions
        function loadWeavingAgents() {
            const pool = document.getElementById('agentPool');
            const summonedAgents = gameState.agents.filter(a => a.summoned);
            
            let html = '';
            summonedAgents.forEach(agent => {
                html += `
                    <div class="pool-agent" onclick="addAgentToWeave('${agent.id}')">
                        ${agent.icon} ${agent.name}
                    </div>
                `;
            });

            pool.innerHTML = html;
        }

        function addAgentToWeave(agentId) {
            if (gameState.selectedAgentsForWeaving.includes(agentId)) return;
            if (gameState.selectedAgentsForWeaving.length >= 5) {
                alert('Maximum 5 agents can be woven together');
                return;
            }

            gameState.selectedAgentsForWeaving.push(agentId);
            updateSelectedAgentsDisplay();
        }

        function removeAgentFromWeave(agentId) {
            gameState.selectedAgentsForWeaving = gameState.selectedAgentsForWeaving.filter(id => id !== agentId);
            updateSelectedAgentsDisplay();
        }

        function updateSelectedAgentsDisplay() {
            const container = document.getElementById('selectedAgents');
            
            if (gameState.selectedAgentsForWeaving.length === 0) {
                container.innerHTML = '<span style="color: var(--text-muted); font-size: 0.875rem;">Click agents below to add them to your weave</span>';
                return;
            }

            let html = '';
            gameState.selectedAgentsForWeaving.forEach(agentId => {
                const agent = gameState.agents.find(a => a.id === agentId);
                if (agent) {
                    html += `
                        <div class="selected-agent">
                            <span>${agent.icon} ${agent.name}</span>
                            <span class="remove" onclick="removeAgentFromWeave('${agentId}')">‚úï</span>
                        </div>
                    `;
                }
            });

            container.innerHTML = html;
        }

        function weaveReality() {
            const intention = document.getElementById('weavingIntention').value;
            if (intention.trim().length < 10) {
                alert('Please provide a clear intention for your manifestation (at least 10 characters)');
                return;
            }

            if (gameState.selectedAgentsForWeaving.length === 0) {
                alert('Please select at least one agent to assist with the weaving');
                return;
            }

            // Create manifestation
            const agentNames = gameState.selectedAgentsForWeaving.map(id => {
                const agent = gameState.agents.find(a => a.id === id);
                return agent ? agent.name : '';
            }).filter(n => n);

            const manifestation = {
                id: Date.now(),
                title: intention.substring(0, 50) + (intention.length > 50 ? '...' : ''),
                agents: agentNames,
                timestamp: Date.now()
            };

            gameState.manifestations.unshift(manifestation);
            gameState.player.manifestations++;
            
            // XP reward
            const xpGain = 500 + (gameState.selectedAgentsForWeaving.length * 100);
            gameState.player.xp += xpGain;
            gameState.player.totalXP += xpGain;

            // Clear
            document.getElementById('weavingIntention').value = '';
            gameState.selectedAgentsForWeaving = [];
            updateSelectedAgentsDisplay();
            loadManifestations();
            updatePlayerStats();

            showModal(
                'Reality Woven!',
                'Your intention has been manifested through the combined power of your agents.',
                `+${xpGain} XP`,
                'Manifestation Complete'
            );
        }

        function loadManifestations() {
            const container = document.getElementById('manifestationLog');
            
            let html = '';
            gameState.manifestations.forEach(m => {
                const timeAgo = getTimeAgo(m.timestamp);
                html += `
                    <div class="manifestation-item">
                        <div class="manifestation-title">${m.title}</div>
                        <div class="manifestation-agents">Agents: ${m.agents.join(', ')}</div>
                        <div class="manifestation-time">${timeAgo}</div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function getTimeAgo(timestamp) {
            const seconds = Math.floor((Date.now() - timestamp) / 1000);
            if (seconds < 60) return 'Just now';
            if (seconds < 3600) return `${Math.floor(seconds / 60)} minutes ago`;
            if (seconds < 86400) return `${Math.floor(seconds / 3600)} hours ago`;
            return `${Math.floor(seconds / 86400)} days ago`;
        }

        // Modal Functions
        function showModal(title, message, xp, badge) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalMessage').textContent = message;
            document.getElementById('modalXP').textContent = xp;
            document.getElementById('modalBadge').textContent = badge;
            document.getElementById('successModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('successModal').classList.remove('active');
        }

        // Utility Functions
        function updatePlayerStats() {
            document.getElementById('playerLevel').textContent = gameState.player.level;
            document.getElementById('playerXP').textContent = formatNumber(gameState.player.xp);
            document.getElementById('agentsSummoned').textContent = gameState.player.agentsSummoned;
            document.getElementById('skillsMastered').textContent = gameState.player.skillsMastered;
        }

        function formatNumber(num) {
            if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            generateStars();
            updatePlayerStats();
        });

        // Close modal on overlay click
        document.getElementById('successModal').addEventListener('click', (e) => {
            if (e.target === document.getElementById('successModal')) {
                closeModal();
            }
        });
    </script>
</body>
</html>
